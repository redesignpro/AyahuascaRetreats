



<!DOCTYPE html>
<html>
<head>
    <title></title>
	
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png?v=16">
	<link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png?v=16">
	<link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png?v=16">
	<link rel="manifest" href="/static/favicon/site.webmanifest?v=16">
	<link rel="mask-icon" href="/static/favicon/safari-pinned-tab.svg?v=16" color="#00c09c">
	<link rel="shortcut icon" href="/static/favicon/favicon.ico?v=16">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="msapplication-config" content="/static/favicon/browserconfig.xml?v=16">
	<meta name="theme-color" content="#02BF9B">

	<link rel="stylesheet" type="text/css" href="./framework.css" />
	<link rel="stylesheet" type="text/css" href="./style.css" />
	

    <script>var CKEDITOR_BASEPATH = '/static/ckeditor/';</script>
	<script>const siteIDToName = {
	
		"1": "BookMartialArts",
	
		"2": "BookCulinaryVacations",
	
		"3": "BookYogaRetreats",
	
		"4": "Tripaneer",
	
		"5": "BookCyclingHolidays",
	
		"6": "BookSinglesHolidays",
	
		"7": "BookSurfCamps",
	
		"8": "BookHorseRidingHolidays",
	
		"9": "BookMeditationRetreats",
	
		"10": "BookYogaTeacherTraining",
	
		"11": "BookDetoxRetreats",
	
		"12": "WeLoveHoneymoons",
	
		"13": "BookAllSafaris",
	
		"14": "BookMotorcycleTours",
	
		"15": "BookRanchVacations",
	
		"16": "BookCountryTours",
	
};
const siteIDToURL = {
	
		"1": "https://www.bookmartialarts.com",
	
		"2": "https://www.bookculinaryvacations.com",
	
		"3": "https://www.bookyogaretreats.com",
	
		"4": "https://www.tripaneer.com",
	
		"5": "https://www.bookcyclingholidays.com",
	
		"6": "https://www.booksinglesholidays.com",
	
		"7": "https://www.booksurfcamps.com",
	
		"8": "https://www.bookhorseridingholidays.com",
	
		"9": "https://www.bookmeditationretreats.com",
	
		"10": "https://www.bookyogateachertraining.com",
	
		"11": "https://www.bookdetoxretreats.com",
	
		"12": "https://www.welovehoneymoons.com",
	
		"13": "https://www.bookallsafaris.com",
	
		"14": "https://www.bookmotorcycletours.com",
	
		"15": "https://www.bookranchvacations.com",
	
		"16": "https://www.bookcountrytours.com",
	
};
const langIDToLang = {
	
		"41": ["en", "English"],
	
		"52": ["de", "German"],
	
		"48": ["fr", "French"],
	
		"39": ["nl", "Dutch"],
	
		"149": ["es", "Spanish"],
	
};
</script>
<script
src="https://code.jquery.com/jquery-1.12.4.js"
integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="
crossorigin="anonymous"
></script>
	<script type="text/javascript" charset="utf-8" src="./lib.js"></script>
	

	<script type="text/javascript" charset="utf-8" src="./logic.js"></script>

	<script>if(typeof(user) == 'undefined'){var user = {};};
user.privileges = {
	
		"OrganizersEdit": 1,
	
		"OrganizersRead": 1,
	
		"ListingsEdit": 1,
	
		"InquiriesEdit": 1,
	
		"InvoicesEdit": 1,
	
		"PayoutsRead": 1,
	
};
</script>
    

	
		<!-- Begin Inspectlet Embed Code -->
<script type="text/javascript" id="inspectletjs">
window.__insp = window.__insp || [];
__insp.push(['wid', 2012022517]);
__insp.push(['identify', "amirrca@yahoo.com"]);
(function() {
function ldinsp(){if(typeof window.__inspld != "undefined") return; window.__inspld = 1; var insp = document.createElement('script'); insp.type = 'text/javascript'; insp.async = true; insp.id = "inspsync"; insp.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://cdn.inspectlet.com/inspectlet.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(insp, x); };
setTimeout(ldinsp, 500); document.readyState != "complete" ? (window.attachEvent ? window.attachEvent('onload', ldinsp) : window.addEventListener('load', ldinsp, false)) : ldinsp();
})();
</script>
<!-- End Inspectlet Embed Code -->

	

	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-104417812-1', 'auto');
  ga('send', 'pageview');

</script>

	

	
		<script src="https://cdn.ravenjs.com/3.17.0/raven.min.js"></script>
		
			<script type="text/javascript">
				Raven.config(
					'https://7b5597f845f945eabda6a1de5f4397fa@sentry.io/231798',
					{
						ignoreErrors: [
							'top.GLOBALS',
							/UET/,
							/Blocked a frame with origin/,
							/__firefox__/,
							'ResizeObserver loop limit exceeded',
						],
						shouldSendCallback(data) {
							return !(
								/CriOS/i.test(navigator.userAgent) ||
								/UCBrowser/i.test(navigator.userAgent) ||
								/UBrowser/i.test(navigator.userAgent)
							)
						}
					}
				).install()
			</script>
		
	

	
		
		<!-- unsubscribe? -->
		<!-- to check/implement : we have to clean up unsubscribed hashes? -->
	

	<style type="text/css">
		@font-face {
			font-family: "ebs-fonticon";
			font-display: swap;
			font-weight: 400;
			font-style: normal;
			src: local('ebs-fonticon'),
				url('/static/fonts/ebs-fonticon/ebs-fonticon.eot?v=hjrU9T9m8');
			src: url('/static/fonts/ebs-fonticon/ebs-fonticon.eot?v=hjrU9T9m8#iefix') format("embedded-opentype"),
				url('/static/fonts/ebs-fonticon/ebs-fonticon.woff2?v=hjrU9T9m8') format("woff2"),
				url('/static/fonts/ebs-fonticon/ebs-fonticon.woff?v=hjrU9T9m8') format("woff"),
				url('/static/fonts/ebs-fonticon/ebs-fonticon.ttf?v=hjrU9T9m8') format("truetype"),
				url('/static/fonts/ebs-fonticon/ebs-fonticon.svg?v=hjrU9T9m8#ebs-fonticon') format("svg");
		}
	</style>

</head>

<body class="office " data-site-id="4">

	


	<nav class="navbar navbar-static-top navbar--mobile">

        <div class="navbar-header">

        	

			<div class="pull-left">
				<ul class="nav navbar-nav">
					
					<li><a class="site-selector-header dropdown-toggle" href="/4/" data-site-id="4">

							
								<i class="office-logo-main"></i>
							

					</a></li>
					
				</ul>
			</div>
        </div>

		
    		<div id="navbar" class="navbar-right">
	            <ul class="nav navbar-nav pull-right">
	            	
	            		<li class="hidden-xs"><a href="/4/">Home</a></li>
	            	

	            	<li class="dropdown">
	            	
	            		
	            		<a class="dropdown-toggle" data-toggle="dropdown" href="#">
	                		<span class="visible-xs text-uppercase">en&nbsp;<i class="fa fa-angle-down" aria-hidden="true"></i></span>
	                		<span class="hidden-xs">English&nbsp;<i class="fa fa-angle-down" aria-hidden="true"></i></span>
	                	</a>
	                	
	                
	            		
	                
	            		
	                
	            		
	                
	            		
	                
		                <ul class="dropdown-menu dropdown-menu-right" role="menu">
		                
		                	
		                
		                	
		                		<li><a href="#" class="language-switch" data-lang-code="de">Deutsch</a></li>
		                	
		                
		                	
		                		<li><a href="#" class="language-switch" data-lang-code="fr">Français</a></li>
		                	
		                
		                	
		                		<li><a href="#" class="language-switch" data-lang-code="nl">Nederlands</a></li>
		                	
		                
		                	
		                		<li><a href="#" class="language-switch" data-lang-code="es">Español</a></li>
		                	
		                
		           		</ul>
					</li>

	                <li class="dropdown">
	                	<a class="dropdown-toggle" data-toggle="dropdown" href="#">
	                		
	                			<span class="visible-xs">
	                				<img src="./my-profile.svg" style="filter: brightness(0%);margin-top: -1px"> &nbsp;<i class="fa fa-angle-down" aria-hidden="true"></i>
	                			</span>
	                			<span class="hidden-xs">My account &nbsp;<i class="fa fa-angle-down" aria-hidden="true"></i></span>
	                		
	                	</a>
	                	<ul class="dropdown-menu dropdown-menu-right" role="menu">
                			<li><a href="/4/user/edit/"><i class="fa fa-key" aria-hidden="true"></i> Change password</a></li>
	                		<li><a href="/4/logout/" rel="nofollow"><i class="fa fa-sign-out" aria-hidden="true"></i> Log out</a></li>
	                	</ul>
	                </li>
	            </ul>
	    	</div>
		

</nav>

<script type="text/javascript">

	$(".language-switch").click(function(e) {
		e.preventDefault;

		$.post( "/language_switch/", { languageCode: $(this).data("langCode") })
			.done(function() {
				location.reload();
			})
		;

	});

</script>

	<div class="container">
    <div id="flash"></div>
</div>


	<div id="main-container" class="container-fluid">

		

		

<header class="mt-header" id="organizer_nav">

	<style type="text/css">
		@media (min-width:1441px){.admin-content {padding: 25px 0}}
		@media screen and (max-width: 767px) {
		    .panel .panel-heading {
		        padding: 16px 8px;
		    }
		    .panel .panel-heading .nav-tabs>li>a {
		    	padding: 16px 8px;
		    	text-transform: none;
		    }
		    .jumbotron p {font-size: 14px}
		}
	    .panel .panel-heading .nav-tabs {
	        padding: 0;
	        border-bottom: none;
	        position: relative;
	        box-shadow: 0 -2px 0 #d9d9d9 inset;
	    }
	    .panel .panel-heading .nav-tabs:after {
	    	content: "";
	    	height: 2px;
	    	background: #D9D9D9;
	    	width: 100%;
	    	bottom: 0;
	    	left: 0;
	    }
	    .panel .panel-heading .nav-tabs>li.active>a,
	    .panel .panel-heading .nav-tabs>li.active>a, .panel .panel-heading .nav-tabs>li>a:hover {
	    	color: #02BF9B !important;
	    }
	    .panel .panel-heading .nav-tabs>li.active>a:after,
	    .panel .panel-heading .nav-tabs>li.active>a:after, .panel .panel-heading .nav-tabs>li>a:hover:after  {
	    	background: #02BF9B
	    }
	</style>
	<script type="text/javascript">
		var siteID = 4,
			orgNavID = 51525
	</script>

	<div class="mt-header__content hidden-phone">
		<div class="mt-header__content__main">
			<h1 class="catamaran">
				Hello Retreats
				
			</h1>
		</div>
		<div class="mt-header__content__secondary">
			<span class="hidden-phone">
				
					
						Business development: Tripaneer
					
					<br/>
				
				<a href="/cdn-cgi/l/email-protection#3c4c5d4e4852594e4f7c484e554c5d5259594e125f5351"><span class="__cf_email__" data-cfemail="6919081b1d070c1b1a291d1b001908070c0c1b470a0604">[email&#160;protected]</span></a><br/>
				
			</span>
			
			<span class="visible-phone">
				<a href="/4/organizers/51525/support/" class="btn btn-link btn-sm"><img src="./t-customer-service.svg" style="width: 24px" /></a>
			</span>
			
		</div>
	</div>
	<ul class="mt-header__tabs js-tabs js-affix">

		


	    <li class="mt-header__tabs__item dropdown ">
	    	<a href=# class="mt-header__tabs__item__link dropdown-toggle" data-toggle="dropdown">
	    		<img src="./inquiries.svg" class="mt-header__tabs__item__link__icon">
	    		Inquiries
	    		<span class="caret"></span>
	    	</a>
			
				<ul class="mt-header__tabs__item__link__dropdown__menu dropdown-menu" role="menu">
					<li><a href="/4/organizers/51525/inquiry-overview/">Inquiries</a></li>
					<li><a href="/4/organizers/51525/bookings-overview/">Bookings</a></li>

					<li role="separator" class="divider"></li>

					<li><a href="/4/organizers/51525/payments/">Payments</a></li>
					<li><a href="/4/organizers/51525/invoices/">Invoices</a></li>
					<li role="separator" class="divider"></li>
					<li><a href="/4/organizers/51525/reviews/">Reviews</a></li>
				</ul>
			
	    </li>
	    <li class="mt-header__tabs__item dropdown ">
	    	<a href=# class="mt-header__tabs__item__link dropdown-toggle" data-toggle="dropdown">
	    		<img src="./my-listings.svg" class="mt-header__tabs__item__link__icon">
	    		My Listings
	    		<span class="caret"></span></a>
			
				<ul class="mt-header__tabs__item__link__dropdown__menu dropdown-menu" role="menu">
					<li><a href="/4/organizers/51525/listings/">Listings</a></li>
					<li><a href="/4/organizers/51525/accommodation/">Accommodations</a></li>
					<li><a href="/4/organizers/51525/instructors/">Instructors</a></li>
					<li><a href="/4/organizers/edit/51525/videos/">Videos</a></li>
				</ul>
			
	    </li>
	    <li class="mt-header__tabs__item dropdown">
	    	<a href=# class="mt-header__tabs__item__link dropdown-toggle" data-toggle="dropdown">
	    		<img src="./my-profile.svg" class="mt-header__tabs__item__link__icon">
	    		My Profile
	    		<span class="caret"></span></a>
	    	<ul class="mt-header__tabs__item__link__dropdown__menu dropdown-menu dropdown-menu--right-on-mobile" role="menu">
	            <li><a href="/4/organizers/edit/51525/public_info/">My Profile Page</a></li>
	            <li><a href="/4/organizers/edit/51525/profile/">Business Information</a></li>
				<li><a href="/4/organizers/edit/51525/payments/">Payment Information</a></li>
				
	            <li role="separator" class="divider"></li>
	            <li><a href="/4/organizers/edit/51525/account/">Account Settings</a></li>
	            <li><a href="/4/organizers/edit/51525/notification_preferences/">Notifications</a>
	        </ul>
	    </li>
		<li class="mt-header__tabs__item ">
			<a href="/4/newsletter/51525/list/" class="mt-header__tabs__item__link"><img src="./marketing.svg" class="mt-header__tabs__item__link__icon"> Marketing</a>
		</li>

		
		<li class="mt-header__tabs__item hidden-phone">
			<a href="/4/organizers/51525/support/" class="mt-header__tabs__item__link"><img src="./support.svg" class="mt-header__tabs__item__link__icon"> Support</a>
		</li>
		
	</ul>
	<div class="js-affix-placeholder affix-placeholder"></div>
</header>


<section class="admin-content ">

	<!-- TO DO: CLEAN UP BREADCRUMBS FROM EDIT PAGES -->
<style>.breadcrumb {display:none}</style>

<div class="row">
	
<style type="text/css">
	#listing_nav.listing-header--has-background-image {background-image: url(https://photos.tpn.to/ee/ee/ee/ee/299x225.webp);}
	@media (min-width:768px){
		#listing_nav.listing-header--has-background-image {background-image: url(https://photos.tpn.to/ee/ee/ee/ee/653x490.webp);}
	}
</style>

<div
	id="listing_nav"
	class="
		listing-header
		
			listing-header--taller
		
		
		js-active-tab-name
	"
	data-tab-name="Listings"
	>

	<div class="listing-header__overlay"></div>

	<div class="listing-header__top">
		<a href="/4/organizers/51525/listings/"><i class="ebs-icon-sec-arrow-left"></i></a>
		<!-- <a href="/4/organizers/51525/listings/"><i class="ebs-icon-close"></i></a> -->
	</div>

	<div class="listing-header__content">
		<div class="listing-header__title">
			<h1 class="catamaran">
				
					Untitled Listing
				
			</h1>
		</div>

		<div class="listing-header__details">
			<div class="btn-toolbar">

				
				

				
				

				
					



	

		<div class="btn-group js-tour-step listing-header__new-listing-assistant" data-step="0" data-tour-name="new_listing_welcome">
			<a href="#listing_checklist_modal" data-toggle="modal" class="btn btn-sm listing-header-btn btn-default btn--progress listing-header__new-listing-assistant__cta">
				35% Complete
				<div class="progress progress--sm progress--purple">
					<div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 35%;"></div>
				</div>
			</a>
			<div class="popover fade top">
				<a href="#" class="close js-tour-end"><i class="ebs-icon-close"></i></a>
				<div class="arrow"></div>
				<div class="popover-content">
					<h4>Required Information</h4>
					<p>Check what information is required to publish your listing online</p>
					<a href="#" class="btn btn-success js-tour-end">OK</a>
				</div>
			</div>
		</div>

		<!-- <div class="btn-group js-tour-step listing-header__new-listing-assistant" data-step="1" data-tour-name="new_listing_welcome">
			<button
				class="btn btn-sm listing-header-btn btn-warning js-approval-requester-button listing-header__new-listing-assistant__cta "
				data-listing-id="95462" p-enable="ListingsEdit"
				data-toggle="tooltip" title="Our editors will review your changes and publish them soon.">
				Request publishing
			</button>
			<div class="popover fade top">
				<a href="#" class="close js-tour-end"><i class="ebs-icon-close"></i></a>
				<div class="arrow"></div>
				<div class="popover-content">
					<h4>Request publishing</h4>
					<p>Our editors will review your listing and provide recommendations.</p>
					<p>You can request it even if the listing is not 100% complete yet.</p>
					<a href="#" class="btn btn-default js-tour-prev">Prev</a>
					<a href="#" class="btn btn-success js-tour-end">OK</a>
				</div>
			</div>
		</div> -->

		<!-- Modal -->
		<div class="modal fade listing-checklist-modal" id="listing_checklist_modal" tabindex="-1" role="dialog" aria-labelledby="listing_checklist_modal">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<!-- <h4 class="modal-title">Required Information - 11 fields to go</h4> -->
						<h4 class="modal-title">Checklist</h4>
						<small>Check what information is required to publish your listing online</small>
					</div>
					<div>
						<ul class="nav nav-tabs nav-tabs--short" role="tablist">
							<li role="presentation" class="active"><a href="#fields" aria-controls="fields" role="tab" data-toggle="tab">Missing Fields</a></li>
							<li role="presentation"><a href="#requirements" aria-controls="requirements" role="tab" data-toggle="tab">Requirements</a></li>
						</ul>

						<div class="tab-content">
							<div role="tabpanel" class="tab-pane active" id="fields">

								<!-- <div class="progress-panel">
									<p class="progress-panel__title">
										<strong>35% complete</strong>
										<span class="text-muted">(6 out of 17)</span>
									</p>
									<div class="progress progress--purple">
										<div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 35%;"></div>
									</div>
								</div> -->

								
									



								<div class="listing-nav listing-nav--modal">
	

	
									<p>Description</p>
									
									<ul class="nav nav-pills nav-stacked">
								
										<li class="nav-tab-intro-title" >
											<a href="./new-listings-title-intro.html">
												 
									
								 
								
												Title &amp; Intro
								
												
													
									<span class="required-label label label-purple-pale">3 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										<li class="nav-tab-location-accommodation" >
											<a href="./new-listings-locations.html">
												 
									
								 
								
												Location &amp; Accommodation
								
												
													
									<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										<li class="nav-tab-arrival-information">
											<a href="./new-listings-arrival-info.html" >
												 
									
								 
								
												Arrival information
								
												
													
									<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										
								
										<li class="nav-tab-guests-requirements" style="display:none">
											<a href="./new-listings-guest-require.html">
												 
									
								 
								
												Guest requirements
								
												
													
								
												
											</a>
										</li>
								
										<li class="nav-tab-program" >
											<a href="./new-listings-program.html">
												 
									
								 
												Program &amp; Itinerary
								
												
													
									<span class="required-label label label-purple-pale">3 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										<li class="nav-tab-pricing-and-inclusions" >
											<a href="./new-listings-pricing-inclusions.html">
												 
									
								 
								
												Pricing &amp; Inclusions
								
												
													
									<span class="required-label label label-purple-pale">3 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										
								
										<li class="nav-tab-photos" >
											<a href="./new-listings-photos.html">
												
									
								
												Photos
								
												
													
									<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										
								
									</ul>
								
									
										<p>Availability &amp; Promoting</p>
									
									<ul class="nav nav-pills nav-stacked">
								
										<li class="nav-tab-availability" >
											<a href="./new-listings-availability-item.html">
								
												Packages &amp; Availability
								
												
													
									<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										<li class="nav-tab-booking-conditions" >
											<a href="./new-listings-booking-conditions.html">
								
												Booking conditions
								
												
													
									<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
								
								
												
											</a>
										</li>
								
										
									</ul>
								
									
								
								</div>


								
							</div>
							<div role="tabpanel" class="tab-pane" id="requirements">
								
									<ul class="requirements-list">
	
		<li>Your account needs to be <strong>approved</strong> first</li>
	
	<li>It must be <strong>focused on the main activity</strong></li>
	<li>It must <strong>include accommodation</strong> during the whole trip</li>
	<li>It must have at least 1 starting date that is more than <strong>6 weeks</strong> away</li>
	<li>The <strong>prices</strong> listed here must be the same or lower as the prices on your website</li>
	<li>It cannot include any of our <a href='https://tripaneer.zendesk.com/hc/en-us/articles/360010278779-What-are-activities-that-Tripaneer-doesn-t-accept-' target='_blank'>banned activities</a></li>
	<li>Flights are not allowed to be part of the package</li>
	<li>It cannot be split into <a href='https://tripaneer.zendesk.com/hc/en-us/articles/360010185520-What-kind-of-trips-can-I-advertise-on-Tripaneer-' target='_blank'>modules</a></li>
</ul>

								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	

	<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
		if ( document.getElementsByClassName("js-tour-step").length ) {

			var tourName = document.getElementsByClassName("js-tour-step")[0].getAttribute("data-tour-name"),
				organizerID = 51525,
				tourCookieName = `organizer_${organizerID}_trigger_tour_${tourName}`,
				browserCookieName = `organizer_${organizerID}_created_listing_in_this_browser`,
				backdropClass = "tour-backdrop",
				backdrop = `<div class="${backdropClass}"></div>`,
				listingIsCompleted = false

			function startTour() {
				step1Container = document.getElementsByClassName("js-tour-step")[0]

				// Adds Backdrop
				window.scrollTo(0, 0);
				document.body.insertAdjacentHTML("afterbegin", backdrop)
				document.body.style.overflow = 'hidden'

				step1Container.classList.add("active")
			}

			function prevTour() {
				let currentContainer = document.getElementsByClassName("js-tour-step active")[0],
					currentStep = currentContainer.getAttribute("data-step"),
					tourName = currentContainer.getAttribute("data-tour-name"),
					prevStep = parseInt(currentStep) - 1,
					prevContainer = document.querySelectorAll(`[data-tour-name="${tourName}"]`)[prevStep]

				if ( prevContainer == undefined ) {
					return false
				} else {
					currentContainer.classList.remove("active")
					prevContainer.classList.add("active")
				}
			}

			function nextTour() {
				let currentContainer = document.getElementsByClassName("js-tour-step active")[0],
					currentStep = currentContainer.getAttribute("data-step"),
					tourName = currentContainer.getAttribute("data-tour-name"),
					nextStep = parseInt(currentStep) + 1,
					nextContainer = document.querySelectorAll(`[data-tour-name="${tourName}"]`)[nextStep]

				if ( nextContainer == undefined ) {
					endTour()
				} else {
					currentContainer.classList.remove("active")
					nextContainer.classList.add("active")
				}
			}

			function endTour() {
				let activeBackdrop = document.getElementsByClassName(backdropClass)[0],
					currentContainer = document.getElementsByClassName("js-tour-step active")[0],
					tourName = currentContainer.getAttribute("data-tour-name")

				currentContainer.classList.remove("active")
				Cookies.set(tourCookieName, false)

				// Removes Backdrop
				activeBackdrop.parentNode.removeChild(activeBackdrop)
				document.body.style.overflow = 'auto'
			}

			// Click events
			document.addEventListener('click', function (event) {

				if (event.target.matches('.js-tour-end')) {
					event.preventDefault()
					endTour()
				}
				if (event.target.matches('.js-tour-prev')) {
					event.preventDefault()
					prevTour()
				}
				if (event.target.matches('.js-tour-next')) {
					event.preventDefault()
					nextTour()
				}

			}, false);

			// If the organizer created the listing in this browser...
			if ( typeof(Cookies.get(browserCookieName)) != 'undefined' ) {

				// Checks if Listing is completed, then sets Cookie for trigering "Listing Completed Tour"
				if ( listingIsCompleted && typeof(Cookies.get(tourCookieName)) == 'undefined' ) {
					Cookies.set(tourCookieName, true)
				}

				// Checks trigger
				if( typeof(Cookies.get(tourCookieName)) != 'undefined' && Cookies.get(tourCookieName) == "true") {

					// Prevents browser from scrolling away from the top on page load
					if ('scrollRestoration' in history) {
						history.scrollRestoration = 'manual';
					}

					// Starts Tour
					document.addEventListener('DOMContentLoaded', function() {
						startTour()
					})
				}
			}
		}
	</script>


				

				
				
					<button id="listing-deactivate" data-listing-id="95462" class="btn btn-sm listing-header-btn btn-danger">
						Deactivate
					</button>
				
			</div>

			
<div class="modal fade" id="new_recommendations_modal" tabindex="-1" role="dialog" aria-labelle>
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">
                        <img src="./recommendationsClose.svg" class="recommendations-modal__close__image"/>
                    </span>
                </button>
                <div class="modal-header__content">
                    <img src="./recommendations.svg" class="recommendations-modal__title__image"/>
                    <h3>Recommendations</h3>
                    <p>Comments from our editors and improvement points to boost your listing</p>
                </div>
            </div>
            <div class="modal-body recommendations-container">
                
            </div>
        </div>
    </div>
</div>

<script>

    function openRecommendationsPage(section) {
        let url = ''
        switch(section) {
            case 'intro':
                url = '/4/listings/95462/edit/introduction/'
                break;
            case 'destinationAndLocation':
                url = '/4/listings/95462/edit/destination_and_location/'
                break;
            case 'arrivalInformation':
                url = '/4/listings/95462/edit/arrival_information/'
                break;
            case 'foodAndDrinks':
                url = '/4/listings/95462/edit/foodAndDrinks/'
                break;
            case 'guestRequirements':
                url = '/4/listings/95462/edit/guest_requirements/'
                break;
            case 'programs':
                url = '/4/listings/95462/edit/program/'
                break;
            case 'pricingAndInclusions':
                url = '/4/listings/95462/edit/pricing_and_inclusions/'
                break;
            case 'extras':
                url = '/4/listings/95462/edit/extras/'
                break;
            case 'photos':
                url = '/4/listings/edit/95462/photos/'
                break;
            case 'packagesAndAvailability':
                url = '/4/listings/edit/95462/availability/'
                break;
            case 'bookingConditions':
                url = '/4/listings/edit/95462/booking-conditions/'
                break;
            default:
                url = '/4/listings/95462/edit/introduction/'
        }
        window.location.href = url;
    }

</script>



		</div>
	</div>

</div>




<script>

	let inputs = $(".number-recommendations");
	let number = 0;
	for(let i = 0; i < inputs.length; i++){
		number += parseInt($(inputs[i]).val())
	}
	$('#number-of-recommendations').html(number);

	// function closeRecommendationPopover() {
	// 	$('.recommendations-popover').addClass('hide');
	// }


</script>

</div>

<div class="row">
	<div class="col-sm-3 col-lg-2 js-listing-nav-left-column">

		<div class="listing-nav-container js-listing-nav-container">
			<a href="#" class="btn btn-default listing-nav-toggler js-listing-nav-toggler">
				<i class="fa fa-bars"></i> Menu <i class="ebs-icon ebs-icon-t-caret-down"></i>
			</a>
			
				



			<div class="listing-nav ">
	

	
				<p>Description</p>
				
				<ul class="nav nav-pills nav-stacked">
			
					<li class="nav-tab-intro-title" >
						<a href="./new-listings-title-intro.html">
							 
				
			 
			
							Title &amp; Intro
			
							
								
				<span class="required-label label label-purple-pale">3 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					<li class="nav-tab-location-accommodation" >
						<a href="./new-listings-locations.html">
							 
				
			 
			
							Location &amp; Accommodation
			
							
								
				<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					<li class="nav-tab-arrival-information">
						<a href="./new-listings-arrival-info.html" >
							 
				
			 
			
							Arrival information
			
							
								
				<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					
						<li class="nav-tab-food">
							<a href="./new-listings-food-drinks.html">
								 
				
			 
			
								Food &amp; Drinks
							</a>
						</li>
					
			
					<li class="nav-tab-guests-requirements" >
						<a href="./new-listings-guest-require.html">
							 
				
			 
			
							Guest requirements
			
							
								
			
							
						</a>
					</li>
			
					<li class="nav-tab-program" >
						<a href="./new-listings-program.html">
							 
				
			 
							Program &amp; Itinerary
			
							
								
				<span class="required-label label label-purple-pale">3 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					<li class="nav-tab-pricing-and-inclusions" >
						<a href="./new-listings-pricing-inclusions.html">
							 
				
			 
			
							Pricing &amp; Inclusions
			
							
								
				<span class="required-label label label-purple-pale">3 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					
						<li class="nav-tab-extras">
							<a href="./new-listings-extras.html">
								 
				
			 
			
								Extras
							</a>
						</li>
					
			
					<li class="nav-tab-photos" >
						<a href="./new-listings-photos.html">
							
				
			
							Photos
			
							
								
				<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					
			
				</ul>
			
				
					<p>Availability &amp; Promoting</p>
				
				<ul class="nav nav-pills nav-stacked">
			
					<li class="nav-tab-availability" >
						<a href="./new-listings-availability-item.html">
			
							Packages &amp; Availability
			
							
								
				<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					<li class="nav-tab-booking-conditions" >
						<a href="./new-listings-booking-conditions.html">
			
							Booking conditions
			
							
								
				<span class="required-label label label-purple-pale">1 <span class="long-label">fields missing</span></span>
			
			
							
						</a>
					</li>
			
					
						<li class="nav-tab-ranking">
							<a href="#">
								Ranking
							</a>
						</li>
					
				</ul>
			
				
					<p>External Pages</p>
					<ul class="nav nav-pills nav-stacked">
			
						<li>
							<a href="#" target="_blank">
								Accommodation
							</a>
						</li>
						<li>
							<a href="#" target="_blank">
								Instructors
							</a>
						</li>
						<li>
							<a href="#" target="_blank">
								Videos
							</a>
						</li>
					</ul>
				
			
			</div>


			
		</div>

	</div>
	<div class="col-sm-9 col-lg-10 js-listing-nav-right-column">


	<div id="listing-deactivate-modal-95462" class="modal fade">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title text-info">Deactivate Listings</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label class="col-sm-3 control-label">Deactivation reason</label>
					<div class="col-sm-9 input-group">
						<select name="reason" class="form-control js-display-hidden-input">
							<option value="0" disabled selected>- select an option -</option>
							
							<option value="101">No new dates for now</option>
							
							<option value="102">We are fully booked</option>
							
							<option value="103">We do not have enough participants</option>
							
							<option value="104">We are not running this holiday anymore</option>
							
							<option value="105">We do not want to list this package with you anymore</option>
							
							<option value="106">The listing needs major updates</option>
							
							<option value="150">We cannot list this package</option>
							
							<option value="164">COVID-19</option>
							
							<option value="165">Business on hold</option>
							
							<option value="166">Temporary out of business</option>
							
						</select>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn btn-success select-reason-to-deactivate-listing" type="button" data-listing-id="95462"><i class="fa fa-check"></i>Save<i class="fa fa-spinner fa-spin hide js-save-spinner"></i></button>
				<button class="btn btn-danger" type="button" data-dismiss="modal">Cancel</button>
			</div>
		</div>
	</div>
</div>




<script>
	$(function () {
		initListingActivation();

		$("#listing-deactivate").click(function () {
			$("#listing-deactivate-modal-95462").modal("show");
		})
	})

	initListingHeader(95462);

	

</script>


	<div id="listing" data-listing-id="95462">

		<div class="section-title">
			<h3>
				Packages &amp; Availability
			</h3>

			
				<div class="recommendation-actions">
       

    	

    	

    
        <div class="modal fade add_recommendations_modal" id="add_recommendations_modal_packagesAndAvailability" tabindex="-1" role="dialog" aria-label>
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">
                        <img src="./recommendationsClose.svg" class="add-recommendations-modal__close__image"/>
                    </span>
                </button>
                <div class="modal-header__content">
                    <img src="./recommendations.svg" class="add-recommendations-modal__title__image"/>
                    <h3>Add recommendation</h3>
                </div>
            </div>
            <div class="add_recommendations_form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="add-recommendation-title">Recommendation for</label>
                        <input type="text" class="form-control add-recommendation-title" placeholder="Packages &amp; Availability (page)" value= "Packages &amp; Availability (page)" readonly />
                    </div>
                    <div class="form-group">
                        <label for="add-recommendation-type">Type   <span id="add-recommendation-type-packagesAndAvailability" class="badge hide">Required</span></label>
                        <div class="btn-group btn-group-toggle" data-toggle="buttons">
                            <label class="btn btn-default">
                                <input type="radio" name="type" value="comment" class="add-recommendation-type" autocomplete="off"> Comment
                            </label>
                            <label class="btn btn-default">
                                <input type="radio" name="type" value="suggestion" autocomplete="off" class="add-recommendation-type"> Improvement
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="add-recommendation-content">Recommendation  <span id ="add-recommendation-content-packagesAndAvailability" class="badge hide">Required</span></label>
                        <textarea class="form-control add-recommendation-content" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button class="btn btn-success add-recommendation-button" type="button" onclick="addRecommendation('packagesAndAvailability', 'page', 'packagesAndAvailability')">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

function addRecommendation(recommendationName, recommendationType, recommendationSection) {
    let field = recommendationName;
    let section = recommendationSection;
    let targetForm = event.target.closest('.add_recommendations_form')
    let feedback = $(targetForm).find('.add-recommendation-content').val();
    let type = $(targetForm).find('.add-recommendation-type:checked').val();
    let feedbackErrorElement = $(targetForm).find(`#add-recommendation-content-${recommendationName}`);
    let typeErrorElement = $(targetForm).find(`#add-recommendation-type-${recommendationName}`);
	let translations = {
		"error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
		"success": "Changes saved successfully"
	}
    if(recommendationType == 'page') {
        section = recommendationSection;
        field = '';
    }
    if(feedback == '' && type == undefined) {
        feedbackErrorElement.removeClass('hide')
        typeErrorElement.removeClass('hide');
        return;
    }

    if(feedback == '') {
        feedbackErrorElement.removeClass('hide');
        return;
    }

    if(type == undefined) {
        typeErrorElement.removeClass('hide');
        return;
    }

    let formData = {
        "type": type,
        "section": section,
        "field": field,
        "feedback": feedback
    }
    let options = {
		credentials: 'same-origin',
		headers: {
			'Accept': 'application/json',
			'Content-Type': 'application/json'
		},
		method: 'POST',
		body: JSON.stringify(formData)
	}
    let url ='/4/listings/95462/feedback/json/create'

    fetch(url, options)
    .then(function(response) {
        if (response.status != 400 && response.status != 200) {
            flash.error(translations.error);
            console.log(response);
        } else {
            flash.success(translations.success, function(){ flash.clear() });
            $(`#add_recommendations_modal_${recommendationName}`).modal('hide')
            return response.json()
        }
    })
}

</script>

    
</div>

<script>

    function showRecommendationHistory(name) {
        let currentElement = event.target;
        $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
        $(currentElement).toggleClass('hide');
        $(currentElement).next().toggleClass('hide'); 
    }

    function hideRecommendationHistory(name) {
        let currentElement = event.target;
        $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
        $(currentElement).toggleClass('hide');
        $(currentElement).prev().toggleClass('hide'); 
    }

</script>


			

			<div class="btn-toolbar">
				<div class="btn-group">
					<a href="#" class="btn btn-outline-default js-listing-nav-column-toggle hidden-phone"><i class="fa fa-bars"></i> Toggle Menu</a>
				</div>
				<div class="btn-group">
					
						<a href="/4/listings/edit/95462/photos/" class="btn btn-outline-default"><i class="ebs-icon ebs-icon-sec-arrow-left"></i> Photos</a>
					
					<a href="/4/listings/edit/95462/booking-conditions/" class="btn btn-outline-default">Booking conditions <i class="ebs-icon ebs-icon-sec-arrow-right"></i></a>
				</div>
			</div>
		</div>

		<div class="panel panel-default">
			<div class="panel-body -airy">

				<div id="availability" i-section="Availability">

					

					
						

<script>

    function completeRecommendation(recommendationId) {
        let targetElement  = event.target;
		let translations = {
			"error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
			"success": "Changes saved successfully"
		};
        let options = {
                        credentials: 'same-origin',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        },
                        method: 'POST'
                    }
        let url =`/4/listings/95462/feedback/${recommendationId}/json/complete`

        fetch(url, options)
        .then(function(response) {
            if (response.status != 200) {
                flash.error(translations.error);
                console.log(response);
            } else {
                flash.success(translations.success, function(){ flash.clear() });
                $(targetElement).closest('.panel-body').find('.content-section span').html('[ Done ]');
                $(targetElement).closest('.button-section').hide();
                return response.json()
            }
        })
    }

    function dismissRecommendation(recommendationId, recommendationType) {
        let targetElement  = event.target;
        let options = {
                        credentials: 'same-origin',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        },
                        method: 'POST'
                    }
        let url =`/4/listings/95462/feedback/${recommendationId}/json/dismiss`

        fetch(url, options)
        .then(function(response) {
            if (response.status != 200) {
                flash.error(translations.error);
                console.log(response);
            } else {
                flash.success(translations.success, function(){ flash.clear() });
                $(targetElement).closest('.panel-body').find('.content-section span').html('[ DISMISSED ]');
                $(targetElement).closest('.button-section').hide();
                return response.json()
            }
        })
    }

    function deleteRecommendation(recommendationId, recommendationType) {
        let targetElement  = event.target;
        let options = {
                        credentials: 'same-origin',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        },
                        method: 'POST'
                    }
        let url =`/4/listings/95462/feedback/${recommendationId}/json/delete`

        if (window.confirm("Are you sure?")) {
            fetch(url, options)
            .then(function(response) {
                if (response.status != 200) {
                    flash.error('Failed to delete recommendation. Try again or report to #application');
                    console.log(response);
                } else {
                    flash.success(translations.success, function(){ flash.clear() });
                    $(targetElement).closest('.panel-body').hide();
                    return response.json()
                }
            })
        }
    }

    function editRecommendation (recommendationName, type, id) {
        $(`#edit_recommendations_modal_${recommendationName}_${type}_${id}`).modal('show');
    }

</script>

						
					

					
					<div class="row section-title">
					
						<div class="col-sm-8">
							<h3>
								Packages
								
									
	
		<span class="required-label label label-purple-pale">
			
				required
			
		</span>
	


								
							</h3>
							<small class="title-description">Note: You may create up to 6 packages.</small>
							<div class="btn-toolbar" style="margin-bottom: 10px">
								<button id="package-creator" class="btn btn-success package-creator " data-currency="CAD" data-listing-id="95462" data-target="#edit-package" data-toggle="modal" p-enable="ListingsEdit" p-no="enable"><i class="fa fa-plus"></i> New Package </button>
							</div>

						</div>
						<div class="col-sm-4">
							

							<div class="alert alert-info-light" role="alert">
								<strong>Tip</strong>: Save time and increase conversion with turning on instant bookings to your packages!
							</div>

						</div>
					</div>


					

				</div>
			</div>

		</div>
	</div>
</section>

<!-- EDIT PACKAGE MODAL -->
<div id="edit-package" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="edit-package-title">Edit Package</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<input type="hidden" id="listing_id_modal">
					<input type="hidden" id="package_id">
					<input type="hidden" id="currency_modal">

					<div class="form-group col-sm-12">
						<label for="nr_persons" class="control-label">Number of People in Package</label>
						<input id="nr_persons" value="1" name="nr_persons" type="number" class="form-control"/>
					</div>
					<div class="form-group col-sm-12">
						<label for="room_id" class="control-label" style="display: block">Room</label>
						<div class="row">
							<div class="col-sm-6">
								<select name="room_id" id="room_id" class="form-control">
									<option value="">Select a room</option>
									
										
											<optgroup label="Brefu">
											
												
													<option value="156547">Master Suite</option>
												
											
												
													<option value="156548">Double Master</option>
												
											
										
										</optgroup>
									
										
											<optgroup label="Baboo">
											
												
													<option value="156546">Baboo</option>
												
											
										
										</optgroup>
									
								</select>
							</div>
							<div class="col-sm-6">
								<a href="/4/organizers/51525/accommodation/" target="_blank" rel="noopener noreferrer" style="padding: 10px 0; display: block">Adjust accommodation and room setup</a>
							</div>
						</div>
					</div>

					

					<div class="form-group col-sm-12" id="accommodation_description_container">
						<label for="accommodation_description" class="control-label">Room / Accommodation <small><i>Deprecated</i></small></label>
						<input id="accommodation_description" name="accommodation_description" type="text" class="form-control"/>
					</div>
					<div class="form-group col-sm-12" id="note_container">
						<label for="note_modal" class="control-label">Note</small></label>
						<input id="note_modal" name="note_modal" type="text" class="form-control"/>
					</div>

					<div class="form-group col-sm-12">
						<label for="price_modal" class="control-label">Total Price in CAD</label>
						<input id="price_modal" name="price_modal" type="number" class="form-control"/>
					</div>
					<div class="form-group col-sm-12">
						<label for="price_modal" class="control-label">Price Calculation</label>
						<textarea id="price_calculation" name="price_calculation" class="form-control" rows="4"></textarea>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button id="modal-save" type="button" data-dismiss="modal" class="btn btn-success"><i class="fa fa-check"></i> Continue</button>
				<button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i> Cancel</button>
			</div>
		</div>
	</div>
</div>

<div id="save-package-alert" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title text-info" id="edit-package-title">Discard changes?</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="form-group col-sm-12">
						<p>It looks like you made some changes in package availability, but did not save them.</p>
						<p>Would you like to save or discard changes?</p>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button id="save-package-alert-button" type="button" data-dismiss="modal" class="btn btn-success"><i class="fa fa-check"></i> Save</button>
				<button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i> Discard</button>
			</div>
		</div>
	</div>
</div>


<script type="text/javascript" charset="utf-8">
	$(".nav-tab-availability").addClass('active');
	// initEditListing(95462,1);

	initEditListingAvailability(siteID, 1);

	function initEditListingAvailability(siteID, isOrganizer) {
		var availabilityInfo = $('#availability-info')[0] ? createEditor('availability-info') : undefined;

		var today = new Date();
		var tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);

		$("#calendar").calendar({
			from: dateToday(),
			rows: 12,
			cols: 2,

			renderer: {
				day: '{day}<div class="price"></div><div class="slots"></div>',
			}
		});

		var stickyLeft = -1;
		var stickyTop = -1;
		var stickyClasses = "";



		function updateUpdateBox() {

			if ( $("#updater-box").length ) {

				var $el = $("#updater-box"),
					$topAnchor = $("#updater-box-top-anchor"),

					$window = $(window),
					topWindow = $window.scrollTop()

					elementHiddenItems = $('.js-filter-selection').height(),
					elementHeight = $el.height() + elementHiddenItems,
					navHeight = $('.js-affix').height(),
					affixedElementHeight = elementHeight + navHeight,

					topAnchor = $topAnchor.offset().top - navHeight,
					leftAnchor = $topAnchor.offset().left,
					anchorWidth = $topAnchor.width()

				if ( $(window).width() < 768 ) {
					$el.removeClass("sticky-abs")
					$el.attr("style", "")

				} else if ($el.length > 0 && $el.is(":visible") && $window.height() > affixedElementHeight ) {

					$el.width(anchorWidth)

					if ((topAnchor) > topWindow) { // sticky at the top when scrolling down and at the bottom when scrolling up
						$el.removeClass("sticky-abs")
					} else {
						$el.addClass("sticky-abs")
						$el.css({
							'left': leftAnchor + 15,
							'top': navHeight // from the organizer menu
						})
					}
				}
			}
		}

		var triggerUpdateBox;
		$(".js-listing-nav-column-toggle").on("click", updateUpdateBox )
		$(window).on("scroll resize touchmove touchend", function(){ triggerUpdateBox = true })

		// Setting interval for better performance
		setInterval(function() {
			if (triggerUpdateBox) {
				updateUpdateBox();
				triggerUpdateBox = false
			}
		}, 100)

		updateUpdateBox();
		$(window).on("resize", function() {
			updateUpdateBox()
		})

		function enableSave() {
			$('.package-table,.panel-heading').on('mouseover',function(){
				$('.package-table,.panel-heading').off('mouseover');
				$('#save-package-alert').modal('show');
			});
			$("#save-availability").removeAttr("disabled");
			$("#save-availability-warning").show();
		}

		function disableSave() {
			$('.package-table,.panel-heading').off('mouseover');
			$("#save-availability").attr("disabled", 1);
			$("#save-availability-warning").hide();
		}

		$('#apply').click(function (event) {
			flash.clear();
			clearValidate("#updater-box");

			if($('input[name=availability-type]:checked').val() == "guaranteed" && $("#slots").val() == ""){
				$("#slots").find("option").first().attr("i-validate", "required");
			}else{
				$("#slots").find("option").first().attr("i-validate", "");
			}

			var error = true;
			$("#updater-box").validate(defaultSaveValidate(), function(errors) {
				error = errors && errors.length;
			});

			if (!error) {
				var dayOfWeek = $('#filter').val();

				var price = $('#price').val();
				var slots = $('#slots').val();
				var changed = false;

				$(".calendar a.selected:not(.disabled)").each(function() {
					var $day = $(this);

					if (!dayOfWeek || ((new Date($day.data("date"))).getDay() == dayOfWeek)) {
						changed |= updateCell($day, $("input[type='radio'][name='availability-type']:checked").val(), price, slots);
					}
				});

				if (changed) {
					enableSave();
				}
			}

			return false;
		});


		function handleInstantCheckbox(){

			var checked = $(this).is(':checked');
			var packageId = $(this).data('package-id').toString();

			if (packageId) {

				$.ajax({
					url: "package-availability/" + packageId + "/",
					method: "GET",

					beforeSend : function(){
						$('#calendar').hide();
						$("#spinner").show();
					},

					success: function (dates, txtStatus, jqXHR) {

						if (checked === true){
							Object.keys(dates).forEach(function(key){
								dates[key]['type'] = 1,
								dates[key]['slots'] = parseInt(dates[key]['booked']) + 1
							});
						} else {
							Object.keys(dates).forEach(function(key){
								dates[key]['type'] = 0
							});
						}

						postJSON("package-availability/" + packageId + "/", {
							dates: dates
							},
							function (result) {
								// $("html, body").animate({ scrollTop: 0 }, 600);
								if (!result.errors || !result.errors.length) {
									$("#in-between-state").removeClass('hidden');
									$(".js-approval-requester-button").removeClass('hidden');

									if ( $('#low_availability_alert').length ) {
										$('#low_availability_alert').hide();
									}

									$('.js-unpublished-changes').removeClass('hidden');

									$(".js-package-selector option:selected").each(function(){ $(this).removeAttr('selected'); });
									$(".js-package-selector option[value='"+packageId+"']").attr('selected', 'selected');

									packageChanged();
									flash.success('Availability Successfully Updated');
									// location.reload();
								} else {
									flash.error(result.errors);
								}
							}
						);
					},

					error: function (jqXHR, txtStatus, error) {
						alert(txtStatus + ' : ' + error)
					}

				});


			}

			return false;
		}

		$(".instant_booking_checkbox").on('change', handleInstantCheckbox);

		function availabilityTypeChanged() {
			var selectedValue = $("input[type='radio'][name='availability-type']:checked").val();
			if (selectedValue == "guaranteed") {
				$('#availability-slots-group').show();
			} else {
				$('#availability-slots-group').hide();
			}

			if (selectedValue != "not_available") {
				$('#availability-price-group').show();
			} else {
				$('#availability-price-group').hide();
			}
		}

		$("[name='availability-type']").on('change', availabilityTypeChanged);

		availabilityTypeChanged();

		function updateAvailabilityBox(cell){

			if(cell.hasClass("guaranteed")){
				$("input[name=availability-type][value=guaranteed]").prop('checked', true);
				$("#price").val(cell.data("price"));
				$("#slots").val(cell.data("slots"));
			}else if(cell.hasClass("available")){
				$("input[name=availability-type][value=available]").prop('checked', true);
				$("#price").val(cell.data("price"));
			}else if(cell.data("price") > 0){
				$("input[name=availability-type][value=not_available]").prop('checked', true);
			}else{
				$("input[name=availability-type][value=guaranteed]").prop('checked', true);
				var packId = $(".js-package-selector").val();
				var price = $("#price_" + packId).data("price");
				$("#price").val(price.toString().replace(/,/g, ""));
			}

			availabilityTypeChanged();
		}

		var $selectStart_;
		var $selecting_;

		$("#calendar .calendar td a").on('mousedown', function(e) {

			var $this = $(this);
			if (!e.ctrlKey){
				$("#calendar .calendar td a").removeClass("selected");
				$("#calendar .calendar td a").removeClass("selected-rest-of-days");
			}

			$selecting_ = !$this.hasClass("selected");
			$this.toggleClass("selected");

			$selectStart_ = $(this);

			updateAvailabilityBox($selectStart_);
		});

		$("#calendar .calendar td a").on('mouseover', function(e) {
			if ($selectStart_ && $selectStart_.length) {

				$("#calendar .calendar td a").removeClass("highlight");

				var $this = $(this);
				var dragStart = parseInt($selectStart_.data("date"));
				var dragEnd = parseInt($this.data("date"));

				if (dragEnd < dragStart) {
					var t = dragEnd;
					dragEnd = dragStart;
					dragStart = t;
				}

				var dates = datesRange(parseInt(dragStart), parseInt(dragEnd));
				for (var i in dates) {
					var date = dates[i];
					var el = $(".calendar a[data-date='" + date + "']:not(.disabled)");
					el.addClass("highlight");
				}
			}
		});

		$(window).on('mouseup', function() {

			var $targets = $(".calendar a.highlight:not(.disabled)").removeClass("highlight");
			$targets.removeClass("selected-rest-of-days");

			if ($selecting_) $targets.addClass("selected");
			else $targets.removeClass("selected");

			//Highlight duration
			var duration = $("#listing_duration").val();
			var $selectedArrival = $targets.length > 0 ? $targets.last() : $selectStart_;
			if($selectedArrival != undefined){

				var $prev = $selectedArrival.parent();
				for(i=1;i<duration;i++){
					var $td = $prev.next();
					while($td.length == 0 || $td.find("a").length == 0){
						if($td.length == 0){
							//Get next week in the month
							var $week = $prev.parent().next();
							if($week.length == 0){
								//get next month
								var $month = getNextMonthInCalendar($prev.closest("table"));
								if($month.length == 0){
									break;
								}
								$week = $month.find("tr");
							}
							$td = $week.find("td").first();
						}else{
							// $td.find("a").length == 0
							$prev = $td;
							$td = $td.next();
						}
					}

					var $a = $td.find("a");
					if($a.prop("class") == undefined ||
						($a.prop("class").indexOf("selected") < 0 &&
						$a.prop("class").indexOf("available") < 0 && $a.prop("class").indexOf("guaranteed") < 0))
							$a.addClass("selected-rest-of-days");

					$prev = $td;
				}
			}//Highlight duration END

			var numSelectedDays = $(".calendar a.selected").length;
			var noDatesContainer = $('#js-no-arrival-dates-selected');
			var someDatesContainer = $('#js-some-arrival-dates-selected');
			var filterDates = $('.js-filter-selection');

			if (numSelectedDays > 0) {

				var numContainer = someDatesContainer.find('span');
				var numContClone = numContainer.clone(true).text(numSelectedDays);

				numContainer.before(numContClone);
				$("." + numContainer.attr("class") + ":last").remove();

				noDatesContainer.hide();
				filterDates.show();
				someDatesContainer.show();

			} else {

				noDatesContainer.show();
				filterDates.hide();
				someDatesContainer.hide();

			}


			$selectStart_ = undefined;
			$selecting_ = undefined;
		});

		function getNextMonthInCalendar($currentTable){
			if ($currentTable.parent().next(".month").length){
				return $currentTable.parent().next(".month").find("table").first();
			}else{
				return $currentTable.parent().parent().next(".month-row").find("table").first();
			}
		}

		$(".js-package-selector").on("change", packageChanged);
		$("#spinner").hide();

		function packageChanged() {
			var packageId = $(".js-package-selector").val();

			if (packageId) {
				return $.ajax({
					url: "package-availability/" + packageId + "/",
					method: "GET",

					beforeSend : function(){
						$('#calendar').hide();
						$("#spinner").show();
					},

					success: function (dates, txtStatus, jqXHR) {
						var dateFull = new Date();
						$(".calendar a[data-date]:not(.disabled)").each(function() {
							var $this = $(this);

							dateFull.setTime($this.data("date"));
							var uint = dateUInt(dateFull);

							if (uint in dates) {
								var info = dates[uint];
								if (info.type == 0) {
									updateCell($this, "available", info.price, info.slots, info.booked);
								} else {
									updateCell($this, "guaranteed", info.price, info.slots, info.booked);
								}
							} else {
								updateCell($this, "not_available", 0, 0, 0);
							}
						});

						var id = $(".js-package-selector").val();
						// var name = $("#acc_desc_" + id).data("room-info");
						var name = $(".js-package-selector option:selected").text();
						console.log(name);
						console.log($(".js-package-selector option:selected"));
						$(".js-selected-package-name").text(name);

						var price = $("#price_" + id).data("price");
						$("#price").val(price.toString().replace(/,/g, ""));

						disableSave();
					},

					error: function (jqXHR, txtStatus, error) {
						alert(txtStatus + ' : ' + error)
					},

					complete: function(){
						$('#calendar').show();
						$("#spinner").hide();
					},
				});
			} else {
				return false
			}
		}

		packageChanged();

		function updateCell($el, type, price, slots, booked) {
			var tooltip = (new Date($el.data('date'))).toString().slice(4,15);;
			if (type == "available") {
				$el.removeClass("guaranteed");
				$el.addClass("available");
				tooltip += "\nConditional Availability";
			} else if (type == "guaranteed") {
				$el.removeClass("available");
				$el.addClass("guaranteed");
				tooltip += "\nGuaranteed Availability";
			} else {
				$el.removeClass("available guaranteed");
				tooltip += "\nNo Availability";
				price = "";
			}

			price = (price ? price : "") | 0;
			slots |= 0;
			booked |= 0;

			$el.data("type", type);
			$el.data("price", price);
			$el.data("slots", slots);
			$el.data("booked", booked);

			$el.find(".price").text(price && price != 0 ? price : "");
			var $slots = $el.find(".slots");

			if (type == "guaranteed") {
				$slots.text(booked + "/" + slots);
				if (slots - booked >= 10) {
					$slots.removeClass("medium low");
				} else if (slots - booked >= 5) {
					$slots.removeClass("low");
					$slots.addClass("medium");
				} else {
					$slots.removeClass("medium");
					$slots.addClass("low");
				}
			} else {
				$slots.text("");
			}

			if(price && price != 0) {
				tooltip += "\nPrice: " + parseFloat(price).toFixed(2) + " " + $("#price").data("currency");
			}

			if (type == "guaranteed") {
				tooltip += "\nBooked: " + booked;
				tooltip += "\nSlots: " + slots;
			}
			$el.attr('title', tooltip);

			return true;
		}

		$('#save-availability, #save-package-alert-button').click(function (e) {
			flash.clear();
			var $saveButton = $(this);

			var originalButtonText = $saveButton.text();
			$saveButton.html('<i class="fa fa-spinner fa-spin"></i>');

			$('#save-package-alert').modal('hide');
			$('.package-table,.panel-heading').off('mouseover');
			var packageId = $(".js-package-selector").val();

			if (packageId) {
				var dates = {};
				var date = new Date();
				$(".calendar a.available").each(function() {
					var $this = $(this);
					date.setTime($(this).data("date"));
					dates[dateUInt(date)] = {
						type: 0,
						price: $this.data("price"),
						slots: $this.data("slots") || 0,
					}; // available
				});

				$(".calendar a.guaranteed").each(function() {
					var $this = $(this);
					date.setTime($this.data("date"));
					dates[dateUInt(date)] = {
						type: 1,
						price: $this.data("price"),
						slots: $this.data("slots") || 0,
					}; // guaranteed
				});

				postJSON("package-availability/" + packageId + "/", {
						dates: dates
					},
					function (result) {
						// $("html, body").animate({ scrollTop: 0 }, 600);
						if (!result.errors || !result.errors.length) {
							$("#in-between-state").removeClass('hidden');
							$('#listing-activate').removeClass('hidden');
							$(".js-approval-requester-button").removeClass('hidden');

							if ( $('#low_availability_alert').length ) {
								$('#low_availability_alert').hide();
							}

							flash.success("Availability Successfully Updated!");
							$saveButton.html(originalButtonText);
							// location.reload();
						} else {
							flash.error(result.errors);
							$saveButton.html(originalButtonText);
						}
					}
				);
			}

			return false;
		});

		$(".js-flexible-duration-checkbox").on('change', function() {
			var checked = $(this).is(':checked');

			var listingID = $(this).data("listing-id");
			$('.js-flexible-duration-checkbox').show()
			$.post('/' + siteID + '/listings/edit/' + listingID + '/update-allow-flexible-duration/?state='+checked, function(data) {

			}).fail(function () {
				flash.error("Uh Oh! Something went wrong.");
				$('.js-flexible-duration-checkbox').hide()
			}).done(function (data) {
				flash.success("Flexible length status successfully saved.");
				$('.js-flexible-duration-checkbox').hide()
			});

			return false;
		});

	}

	$('#room_id').change(function() {
		if ($(this).val() == '') {
			$("#accommodation_description").prop('disabled', false);
		}
		else {
			$("#accommodation_description").prop('disabled', true);
		}
	});

	$(".package-editer").click(function() {
		var button = $(this);
		var packageID = button.data("packageId");
		var nrPersons = button.data("nrPersons");
		var accommodationDesc	= button.data("accommodationDesc");
		var roomID = button.data("roomId");
		var note	= button.data("note");
		var ziPrice = button.data("price") + '';
		var price	= ziPrice ? ziPrice.split(",").join("") : '';
		var currency = button.data("currency");
		var listingID = button.data("listingId");
		var priceCalculation = button.data("priceCalculation");
		var isSuperUser = button.data("isSuperUser");

		$("#listing_id_modal").val(listingID);
		$("#package_id").val(packageID);
		$("#nr_persons").val(nrPersons);
		$("#accommodation_description").val(accommodationDesc);

		if (roomID != 0) {
			$("#accommodation_description").prop('disabled', true);
			//$('#note_modal').prop('disabled', true);
			$("#room_id").val(roomID);
		} else {
			$("#accommodation_description").prop('disabled', false);
			//$('#note_modal').prop('disabled', false);
			$("#room_id").val('');
		}

		$("#note_modal").val(note);
		$("#price_modal").val(price);
		$("#currency_modal").val(currency);
		$("#price_calculation").val(priceCalculation);

		$("#edit-package-title").text("Edit package");
	});

	// Prevent bugs in old browsers that can't handle decimals on input[type="number"]
	$("#price_modal").on("keypress", function(event){
		if ( isNaN(parseInt(event.key,10) ) ) event.preventDefault()
	})

	$(".package-creator").click(function() {
		var button = $(this);
		var currency = button.data("currency");
		var listingID = button.data("listingId");
		var isSuperUser = button.data("isSuperUser");

		$("#currency_modal").val(currency);
		$("#listing_id_modal").val(listingID);
		$("#package_id").val("");
		$("#nr_persons").val(1);
		$("#accommodation_description").val("");
		$("#note_modal").val("");
		$("#price_modal").val("");
		$("#price_calculation").val("");
		$("#room_id").val('');

		$("#room_id").val('');

		$("#edit-package-title").text("Create a new package");
	});

	function addErrorToField(field, errorMessage) {
		field.closest(".form-group").addClass("has-error")
		field.closest(".form-group").append(`<span class="help-block js-error-msg">${errorMessage}</span>`)
	}

	function removeErrorsFromForm(form) {
		form.find(".form-group").removeClass("has-error")
		form.find(".js-error-msg").remove()
	}

	$("#modal-save").click(function() {
		var form		 	= $(this).closest(".modal-dialog");
		var packID			= $("#package_id").val();
		var listingID		= $("#listing_id_modal").val();
		var nrPersons		= $("#nr_persons");
		var roomID			= $("#room_id");
		var note			= $("#note_modal");
		var accDesc			= $("#accommodation_description");
		var price			= $("#price_modal");
		var currency		= $("#currency_modal");
		var priceCalculation = $("#price_calculation");
		var priceForCheck 	= price.val().replace(/,/, '');
		var errors;
		var url;

		removeErrorsFromForm(form)
		errors = 0;

		if (nrPersons.val() != parseInt(nrPersons.val(), 10)) {
			addErrorToField(nrPersons, "Please choose a valid number.")
			errors++
		}

		if( !priceForCheck ) {
			addErrorToField(price, "required")
			errors++
		} else if (isNaN(priceForCheck)) {
			addErrorToField(price, "Please, fill in a valid price (only numbers).")
			errors++
		}

		if (roomID.val() == 0 && accDesc.val().length === 0) {
			addErrorToField(roomID, "required")
			errors++
		}

		if ( errors > 0 ) return false

		if (packID)
			url = "/" + siteID + "/listings/edit-package/" + packID + "/";
		else
			url = "/" + siteID + "/listings/create-package/";

		$.post( url, {
			listing_id					: listingID,
			nr_persons					: nrPersons.val(),
			room_id						: roomID.val(),
			price						: price.val(),
			note 						: note.val(),
			accommodation_description 	: accDesc.val(),
			currency					: currency.val(),
			price_calculation			: priceCalculation.val()
		}, function( data ) {
			// success and we got back the id of the new package
			if (!data || isInt(data)) {
				var thisURL = window.location.href;
				var destinationURL = thisURL;
				window.location.href = destinationURL;
				window.location.reload();
			} else {
				// there was an error
				alert(data);
			}
		}).done(function() {
		}).fail(function() {
			alert("Failed to save your data.")
		});
	});

	$(".package-deleter").click(function() {
		var button = $(this);
		var id = button.data("packageId");

		if (window.confirm("Are you sure?")) {
				$.post( '/'+siteID+'/listings/delete-package/' + id + '/', function( data ) {
					button.parent().parent().remove();
					var nrPackagesAvailable = $("#package-holder tr").length;
					if (nrPackagesAvailable < 6)
						$("#package-creator").removeClass("disabled");

					$("#in-between-state").removeClass('hidden');
					$(".js-approval-requester-button").removeClass('hidden');
					flash.success("Package successfully deleted!", function(){window.location.reload()});
				});
			}

		return false;
	});

	enforcePrivileges();

</script>


		
			<div class="organizer--feedback">
	<div class="js-org-feedback-controls organizer--feedback-container">

		<div class="js-feedback-initial organizer--feedback-form">
			<label>Do you find this page and its features useful?</label>

			<input class="btn btn-sm btn-outline-secondary" id="org_feedback_yes" type="button" value="Yes" onclick="submitOrgFeedback(1);">
			<input class="btn btn-sm btn-outline-secondary" id="org_feedback_no" type="button" value="No" onclick="submitOrgFeedback(0);">
		</div>

		<div class="js-feedback-text organizer--feedback-message" style="display: none;">

			<label>How could we improve it for you?</label>
			<textarea id="orgFeedbackMessageInput"></textarea>
			<small>For immediate support we recommend getting in touch with your account manager, these messages are not constantly monitored.</small>

			<input type="button" class="btn btn-outline-secondary" onclick="submitOrgFeedback(2);" value="Send feedback">
		</div>
	</div>

	<div hidden id="organizer_feedback_submitted" class="organizer--feedback-container">
		<label>Your feedback was sent to our team, thanks for helping us making our tools match your expectations.</label>
	</div>
</div>

<script>

	function showOrgFeedbackMessage(){
		$('.js-feedback-initial').hide()
		$('.js-feedback-text').show()
	}
	var feedbackType = "undefined";
	function submitOrgFeedback(state_){
		if(state_ == 0) {
			feedbackType = "negative";
		} else if(state_ == 1) {
			feedbackType = "positive";
		}

		$.ajax({
			url: '/organizer_feedback',
			type: 'POST',
			dataType: 'json',
			contentType: 'application/json',
			data : JSON.stringify({
						url: "https://office.tripaneer.com/4/listings/edit/95462/availability/",
						state: state_,
						type: feedbackType,
						message:$("#orgFeedbackMessageInput").val()
					}),
			statusCode:{
				200: function(response){
					if (response.error != undefined) {
						flash.error(response.error);
						return;
					}
					if(state_ == 2){
						$("#organizer_feedback_submitted").show();
						$(".js-org-feedback-controls").hide();
					} else {
						showOrgFeedbackMessage();
					}
				}
			}
		});
}
</script>

		

	</div>

	
</body>

</html>

