{% extends './base-listing.html' %}
{% load static %}
{% block content %}
            <div class="section-title">
              <h3>Location &amp; Accommodation</h3>
              <small class="title-description"> Introduce the trip and highlight what&#39;s unique about your program </small>
              <div class="recommendation-actions">
                <div class="modal fade add_recommendations_modal" id="add_recommendations_modal_intro" tabindex="-1" role="dialog" aria-label>
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">
                            <img src="./recommendationsClose.svg" class="add-recommendations-modal__close__image" />
                          </span>
                        </button>
                        <div class="modal-header__content">
                          <img src="./recommendations.svg" class="add-recommendations-modal__title__image" />
                          <h3>Add recommendation</h3>
                        </div>
                      </div>
                      <div class="add_recommendations_form">
                        <div class="modal-body">
                          <div class="form-group">
                            <label for="add-recommendation-title">Recommendation for</label>
                            <input type="text" class="form-control add-recommendation-title" placeholder="Title &amp; Intro (page)" value="Title &amp; Intro (page)" readonly />
                          </div>
                          <div class="form-group">
                            <label for="add-recommendation-type">Type <span id="add-recommendation-type-intro" class="badge hide">Required</span>
                            </label>
                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                              <label class="btn btn-default">
                                <input type="radio" name="type" value="comment" class="add-recommendation-type" autocomplete="off"> Comment </label>
                              <label class="btn btn-default">
                                <input type="radio" name="type" value="suggestion" autocomplete="off" class="add-recommendation-type"> Improvement </label>
                            </div>
                          </div>
                          <div class="form-group">
                            <label for="add-recommendation-content">Recommendation <span id="add-recommendation-content-intro" class="badge hide">Required</span>
                            </label>
                            <textarea class="form-control add-recommendation-content" rows="3"></textarea>
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                          <button class="btn btn-success add-recommendation-button" type="button" onclick="addRecommendation('intro', 'page', 'intro')">Save</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <script>
                  function addRecommendation(recommendationName, recommendationType, recommendationSection) {
                    let field = recommendationName;
                    let section = recommendationSection;
                    let targetForm = event.target.closest('.add_recommendations_form')
                    let feedback = $(targetForm).find('.add-recommendation-content').val();
                    let type = $(targetForm).find('.add-recommendation-type:checked').val();
                    let feedbackErrorElement = $(targetForm).find(`#add-recommendation-content-${recommendationName}`);
                    let typeErrorElement = $(targetForm).find(`#add-recommendation-type-${recommendationName}`);
                    let translations = {
                      "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                      "success": "Changes saved successfully"
                    }
                    if (recommendationType == 'page') {
                      section = recommendationSection;
                      field = '';
                    }
                    if (feedback == '' && type == undefined) {
                      feedbackErrorElement.removeClass('hide')
                      typeErrorElement.removeClass('hide');
                      return;
                    }
                    if (feedback == '') {
                      feedbackErrorElement.removeClass('hide');
                      return;
                    }
                    if (type == undefined) {
                      typeErrorElement.removeClass('hide');
                      return;
                    }
                    let formData = {
                      "type": type,
                      "section": section,
                      "field": field,
                      "feedback": feedback
                    }
                    let options = {
                      credentials: 'same-origin',
                      headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                      },
                      method: 'POST',
                      body: JSON.stringify(formData)
                    }
                    let url = '/4/listings/95462/feedback/json/create'
                    fetch(url, options).then(function(response) {
                      if (response.status != 400 && response.status != 200) {
                        flash.error(translations.error);
                        console.log(response);
                      } else {
                        flash.success(translations.success, function() {
                          flash.clear()
                        });
                        $(`#add_recommendations_modal_${recommendationName}`).modal('hide')
                        return response.json()
                      }
                    })
                  }
                </script>
              </div>
              <script>
                function showRecommendationHistory(name) {
                  let currentElement = event.target;
                  $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                  $(currentElement).toggleClass('hide');
                  $(currentElement).next().toggleClass('hide');
                }

                function hideRecommendationHistory(name) {
                  let currentElement = event.target;
                  $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                  $(currentElement).toggleClass('hide');
                  $(currentElement).prev().toggleClass('hide');
                }
              </script>
            </div>
            <div class="panel panel-default">
              <div class="panel-body -airy">
				<div role="tabpanel" class="tab-pane active has-fixed-actions">
                    <form id="destination-form" class="js-serialize-this-form" method='POST' enctype="multipart/form-data">
                      {% csrf_token %}
                      {{ form.media }}
                      <script>
                        function completeRecommendation(recommendationId) {
                          let targetElement = event.target;
                          let translations = {
                            "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                            "success": "Changes saved successfully"
                          };
                          let options = {
                            credentials: 'same-origin',
                            headers: {
                              'Accept': 'application/json',
                              'Content-Type': 'application/json'
                            },
                            method: 'POST'
                          }
                          let url = `/4/listings/95462/feedback/${recommendationId}/json/complete`
                          fetch(url, options).then(function(response) {
                            if (response.status != 200) {
                              flash.error(translations.error);
                              console.log(response);
                            } else {
                              flash.success(translations.success, function() {
                                flash.clear()
                              });
                              $(targetElement).closest('.panel-body').find('.content-section span').html('[ Done ]');
                              $(targetElement).closest('.button-section').hide();
                              return response.json()
                            }
                          })
                        }
  
                        function dismissRecommendation(recommendationId, recommendationType) {
                          let targetElement = event.target;
                          let options = {
                            credentials: 'same-origin',
                            headers: {
                              'Accept': 'application/json',
                              'Content-Type': 'application/json'
                            },
                            method: 'POST'
                          }
                          let url = `/4/listings/95462/feedback/${recommendationId}/json/dismiss`
                          fetch(url, options).then(function(response) {
                            if (response.status != 200) {
                              flash.error(translations.error);
                              console.log(response);
                            } else {
                              flash.success(translations.success, function() {
                                flash.clear()
                              });
                              $(targetElement).closest('.panel-body').find('.content-section span').html('[ DISMISSED ]');
                              $(targetElement).closest('.button-section').hide();
                              return response.json()
                            }
                          })
                        }
  
                        function deleteRecommendation(recommendationId, recommendationType) {
                          let targetElement = event.target;
                          let options = {
                            credentials: 'same-origin',
                            headers: {
                              'Accept': 'application/json',
                              'Content-Type': 'application/json'
                            },
                            method: 'POST'
                          }
                          let url = `/4/listings/95462/feedback/${recommendationId}/json/delete`
                          if (window.confirm("Are you sure?")) {
                            fetch(url, options).then(function(response) {
                              if (response.status != 200) {
                                flash.error('Failed to delete recommendation. Try again or report to #application');
                                console.log(response);
                              } else {
                                flash.success(translations.success, function() {
                                  flash.clear()
                                });
                                $(targetElement).closest('.panel-body').hide();
                                return response.json()
                              }
                            })
                          }
                        }
  
                        function editRecommendation(recommendationName, type, id) {
                          $(`#edit_recommendations_modal_${recommendationName}_${type}_${id}`).modal('show');
                        }
                      </script>
                      <div class="row">
                        <div class="col-md-9">
                          <div class="row listing-enhancement__title">
                            <div class="col-sm-9">
                              <h3 class="catamaran">Destination &amp; Location</h3>
                            </div>
                          </div>
                        </div>
                      </div>
                      <br>
                      <br>
                      <!--------------------------------------------------COUNTRY------------------------------------------------>
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="country" class="control-label label-block"> Country </label>
                            <div class="form-helper"> Select the country in which the trip will take place. If you&#39;re offering a mult-countries tour, please select the country where most of the tour will happen. </div>
                            <div class="recommendation-actions">
                              <div class="modal fade add_recommendations_modal" id="add_recommendations_modal_country_id" tabindex="-1" role="dialog" aria-label>
                                <div class="modal-dialog modal-lg" role="document">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">
                                          <img src="./recommendationsClose.svg" class="add-recommendations-modal__close__image" />
                                        </span>
                                      </button>
                                      <div class="modal-header__content">
                                        <img src="./recommendations.svg" class="add-recommendations-modal__title__image" />
                                        <h3>Add recommendation</h3>
                                      </div>
                                    </div>
                                    <div class="add_recommendations_form">
                                      <div class="modal-body">
                                        <div class="form-group">
                                          <label for="add-recommendation-title">Recommendation for</label>
                                          <input type="text" class="form-control add-recommendation-title" placeholder="Country (field)" value="Country (field)" readonly />
                                        </div>
                                        <div class="form-group">
                                          <label for="add-recommendation-type">Type <span id="add-recommendation-type-country_id" class="badge hide">Required</span>
                                          </label>
                                          <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                            <label class="btn btn-default">
                                              <input type="radio" name="type" value="comment" class="add-recommendation-type" autocomplete="off"> Comment </label>
                                            <label class="btn btn-default">
                                              <input type="radio" name="type" value="suggestion" autocomplete="off" class="add-recommendation-type"> Improvement </label>
                                          </div>
                                        </div>
                                        <div class="form-group">
                                          <label for="add-recommendation-content">Recommendation <span id="add-recommendation-content-country_id" class="badge hide">Required</span>
                                          </label>
                                          <textarea class="form-control add-recommendation-content" rows="3"></textarea>
                                        </div>
                                      </div>
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                        <button class="btn btn-success add-recommendation-button" type="button" onclick="addRecommendation('country_id', 'field', 'destinationAndLocation')">Save</button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <script>
                                function addRecommendation(recommendationName, recommendationType, recommendationSection) {
                                  let field = recommendationName;
                                  let section = recommendationSection;
                                  let targetForm = event.target.closest('.add_recommendations_form')
                                  let feedback = $(targetForm).find('.add-recommendation-content').val();
                                  let type = $(targetForm).find('.add-recommendation-type:checked').val();
                                  let feedbackErrorElement = $(targetForm).find(`#add-recommendation-content-${recommendationName}`);
                                  let typeErrorElement = $(targetForm).find(`#add-recommendation-type-${recommendationName}`);
                                  let translations = {
                                    "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                    "success": "Changes saved successfully"
                                  }
                                  if (recommendationType == 'page') {
                                    section = recommendationSection;
                                    field = '';
                                  }
                                  if (feedback == '' && type == undefined) {
                                    feedbackErrorElement.removeClass('hide')
                                    typeErrorElement.removeClass('hide');
                                    return;
                                  }
                                  if (feedback == '') {
                                    feedbackErrorElement.removeClass('hide');
                                    return;
                                  }
                                  if (type == undefined) {
                                    typeErrorElement.removeClass('hide');
                                    return;
                                  }
                                  let formData = {
                                    "type": type,
                                    "section": section,
                                    "field": field,
                                    "feedback": feedback
                                  }
                                  let options = {
                                    credentials: 'same-origin',
                                    headers: {
                                      'Accept': 'application/json',
                                      'Content-Type': 'application/json'
                                    },
                                    method: 'POST',
                                    body: JSON.stringify(formData)
                                  }
                                  let url = '/4/listings/95462/feedback/json/create'
                                  fetch(url, options).then(function(response) {
                                    if (response.status != 400 && response.status != 200) {
                                      flash.error(translations.error);
                                      console.log(response);
                                    } else {
                                      flash.success(translations.success, function() {
                                        flash.clear()
                                      });
                                      $(`#add_recommendations_modal_${recommendationName}`).modal('hide')
                                      return response.json()
                                    }
                                  })
                                }
                              </script>
                            </div>
                            <script>
                              function showRecommendationHistory(name) {
                                let currentElement = event.target;
                                $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                $(currentElement).toggleClass('hide');
                                $(currentElement).next().toggleClass('hide');
                              }
  
                              function hideRecommendationHistory(name) {
                                let currentElement = event.target;
                                $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                $(currentElement).toggleClass('hide');
                                $(currentElement).prev().toggleClass('hide');
                              }
                            </script>
                          </div>
                        </div>
                        <div class="col-lg-6 col-md-9 col-xs-12">
                          <div class="form-group">
                              {{ form.country }}
                          </div>
                          <script>
                            function completeRecommendation(recommendationId) {
                              let translations = {
                                "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                "success": "Changes saved successfully"
                              };
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/complete`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  flash.error(translations.error);
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ Done ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function dismissRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/dismiss`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  if (recommendationType == 'comment') {
                                    flash.error(translations.error);
                                  } else {
                                    flash.error(translations.error);
                                  }
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ DISMISSED ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function deleteRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/delete`
                              if (window.confirm("Are you sure?")) {
                                fetch(url, options).then(function(response) {
                                  if (response.status != 200) {
                                    flash.error(translations.error);
                                    console.log(response);
                                  } else {
                                    flash.success(translations.success, function() {
                                      flash.clear()
                                    });
                                    $(targetElement).closest('.panel-body').hide();
                                    return response.json()
                                  }
                                })
                              }
                            }
  
                            function editRecommendation(recommendationName, type, id) {
                              $(`#edit_recommendations_modal_${recommendationName}_${type}_${id}`).modal('show');
                            }
                          </script>
                        </div>
                      </div>
                      <!--------------------------------------------------ADDRESS------------------------------------------------>
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="address" class="control-label label-block"> Address </label>
                            <div class="form-helper"> Provide the full address of the venue, include street name, city, region, province and state. Address </div>
                            <div class="recommendation-actions">
                              <div class="modal fade add_recommendations_modal" id="add_recommendations_modal_address" tabindex="-1" role="dialog" aria-label>
                                <div class="modal-dialog modal-lg" role="document">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">
                                          <img src="./recommendationsClose.svg" class="add-recommendations-modal__close__image" />
                                        </span>
                                      </button>
                                      <div class="modal-header__content">
                                        <img src="./recommendations.svg" class="add-recommendations-modal__title__image" />
                                        <h3>Add recommendation</h3>
                                      </div>
                                    </div>
                                    <div class="add_recommendations_form">
                                      <div class="modal-body">
                                        <div class="form-group">
                                          <label for="add-recommendation-title">Recommendation for</label>
                                          <input type="text" class="form-control add-recommendation-title" placeholder="Address (field)" value="Address (field)" readonly />
                                        </div>
                                        <div class="form-group">
                                          <label for="add-recommendation-type">Type <span id="add-recommendation-type-address" class="badge hide">Required</span>
                                          </label>
                                          <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                            <label class="btn btn-default">
                                              <input type="radio" name="type" value="comment" class="add-recommendation-type" autocomplete="off"> Comment </label>
                                            <label class="btn btn-default">
                                              <input type="radio" name="type" value="suggestion" autocomplete="off" class="add-recommendation-type"> Improvement </label>
                                          </div>
                                        </div>
                                        <div class="form-group">
                                          <label for="add-recommendation-content">Recommendation <span id="add-recommendation-content-address" class="badge hide">Required</span>
                                          </label>
                                          <textarea class="form-control add-recommendation-content" rows="3"></textarea>
                                        </div>
                                      </div>
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                        <button class="btn btn-success add-recommendation-button" type="button" onclick="addRecommendation('address', 'field', 'destinationAndLocation')">Save</button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <script>
                                function addRecommendation(recommendationName, recommendationType, recommendationSection) {
                                  let field = recommendationName;
                                  let section = recommendationSection;
                                  let targetForm = event.target.closest('.add_recommendations_form')
                                  let feedback = $(targetForm).find('.add-recommendation-content').val();
                                  let type = $(targetForm).find('.add-recommendation-type:checked').val();
                                  let feedbackErrorElement = $(targetForm).find(`#add-recommendation-content-${recommendationName}`);
                                  let typeErrorElement = $(targetForm).find(`#add-recommendation-type-${recommendationName}`);
                                  let translations = {
                                    "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                    "success": "Changes saved successfully"
                                  }
                                  if (recommendationType == 'page') {
                                    section = recommendationSection;
                                    field = '';
                                  }
                                  if (feedback == '' && type == undefined) {
                                    feedbackErrorElement.removeClass('hide')
                                    typeErrorElement.removeClass('hide');
                                    return;
                                  }
                                  if (feedback == '') {
                                    feedbackErrorElement.removeClass('hide');
                                    return;
                                  }
                                  if (type == undefined) {
                                    typeErrorElement.removeClass('hide');
                                    return;
                                  }
                                  let formData = {
                                    "type": type,
                                    "section": section,
                                    "field": field,
                                    "feedback": feedback
                                  }
                                  let options = {
                                    credentials: 'same-origin',
                                    headers: {
                                      'Accept': 'application/json',
                                      'Content-Type': 'application/json'
                                    },
                                    method: 'POST',
                                    body: JSON.stringify(formData)
                                  }
                                  let url = '/4/listings/95462/feedback/json/create'
                                  fetch(url, options).then(function(response) {
                                    if (response.status != 400 && response.status != 200) {
                                      flash.error(translations.error);
                                      console.log(response);
                                    } else {
                                      flash.success(translations.success, function() {
                                        flash.clear()
                                      });
                                      $(`#add_recommendations_modal_${recommendationName}`).modal('hide')
                                      return response.json()
                                    }
                                  })
                                }
                              </script>
                            </div>
                            <script>
                              function showRecommendationHistory(name) {
                                let currentElement = event.target;
                                $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                $(currentElement).toggleClass('hide');
                                $(currentElement).next().toggleClass('hide');
                              }
  
                              function hideRecommendationHistory(name) {
                                let currentElement = event.target;
                                $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                $(currentElement).toggleClass('hide');
                                $(currentElement).prev().toggleClass('hide');
                              }
                            </script>
                          </div>
                        </div>
                        <div class="col-lg-6 col-md-9 col-xs-12">
                          <div class="form-group">
                            {{ form.address }}
                          </div>
                          <script>
                            function completeRecommendation(recommendationId) {
                              let translations = {
                                "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                "success": "Changes saved successfully"
                              };
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/complete`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  flash.error(translations.error);
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ Done ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function dismissRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/dismiss`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  if (recommendationType == 'comment') {
                                    flash.error(translations.error);
                                  } else {
                                    flash.error(translations.error);
                                  }
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ DISMISSED ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function deleteRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/delete`
                              if (window.confirm("Are you sure?")) {
                                fetch(url, options).then(function(response) {
                                  if (response.status != 200) {
                                    flash.error(translations.error);
                                    console.log(response);
                                  } else {
                                    flash.success(translations.success, function() {
                                      flash.clear()
                                    });
                                    $(targetElement).closest('.panel-body').hide();
                                    return response.json()
                                  }
                                })
                              }
                            }
  
                            function editRecommendation(recommendationName, type, id) {
                              $(`#edit_recommendations_modal_${recommendationName}_${type}_${id}`).modal('show');
                            }
                          </script>
                        </div>
                      </div>
                      <!------------------------------------------------------- Geo location ------------------------------------------>
                      <!-- <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="geo-location" class="control-label label-block"> Geo location <span class="required-label label label-purple-pale"> required </span>
                            </label>
                            <div class="form-helper"> Automatically detected from address above </div>
                          </div>
                        </div>
                        <div class="col-lg-6 col-md-9 col-xs-12">
                          <div class="form-group">
                            <input type="text" readonly class="form-control" id="location-georef" value="Not available" />
                            <input name="lat" id="lat" type="hidden" value="nan">
                            <input name="lng" id="lng" type="hidden" value="nan">
                            <input type=hidden name="isLiveEnv" id="isLiveEnv" value="true">
                            <div class="btn-group" style="margin-top: 8px">
                              <button class="btn btn-default btn-sm btn-info" name="location" id="location-view-map" type="button" data-target="#location-modal">
                                <i class="fa fa-map-marker"></i> Pick from address </button>
                              <button class="btn btn-default btn-sm btn-default" id="reset-geo-location">
                                <i class="fa fa-close"></i> Reset </button>
                            </div>
                          </div>
                        </div>
                      </div> -->
                      <!-- <div id="location-modal" class="modal fade" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-lg" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                              <h4 class="modal-title">Pick a Geo Location</h4>
                              <p>
                                <strong>Note</strong>: Click and drag the marker on the map to pinpoint the precise location of <i>
                                  <span id="location-modal-title"></span>
                                </i>. If necessary, please adjust the zoom level.
                              </p>
                              <br>
                              <p>
                                <strong>Warning</strong>: Only use the Geo Picker if you know the exact location of the activity. The location will be displayed on your listing and customers will expect it to be at the location displayed.
                              </p>
                            </div>
                            <div class="modal-body">
                              <div id="modal-location-map"></div>
                            </div>
                            <div class="modal-footer">
                              <button id="location-modal-ok" type="button" class="btn btn-success">
                                <i class="fa fa-check"></i> OK </button>
                              <button type="button" class="btn btn-danger" data-dismiss="modal">
                                <i class="fa fa-times"></i> Cancel </button>
                            </div>
                          </div>
                        </div>
                      </div> -->
                      <!------------------------------------------------------- LOCATION ------------------------------------------>
                      <div class="row section-title divider-on-top">
                        <div class="col-md-9 col-sm-12">
                          <h3>Location</h3>
                          <small class="title-description">Share what makes the location and neighborhood special. Describe what customers can find nearby.</small>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="location" class="control-label label-block"> Content </label>
                            <div class="form-helper"> Formatting help: <br /> - Header starts with a dash <br /> * list items start with asterisk <br /> % paragraphs start with percent <br />
                              <br /> Long lines are turned into paragraphs and short lines are turned into lists automatically. <div class="recommendation-actions">
                                <div class="modal fade add_recommendations_modal" id="add_recommendations_modal_location" tabindex="-1" role="dialog" aria-label>
                                  <div class="modal-dialog modal-lg" role="document">
                                    <div class="modal-content">
                                      <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                          <span aria-hidden="true">
                                            <img src="./recommendationsClose.svg" class="add-recommendations-modal__close__image" />
                                          </span>
                                        </button>
                                        <div class="modal-header__content">
                                          <img src="./recommendations.svg" class="add-recommendations-modal__title__image" />
                                          <h3>Add recommendation</h3>
                                        </div>
                                      </div>
                                      <div class="add_recommendations_form">
                                        <div class="modal-body">
                                          <div class="form-group">
                                            <label for="add-recommendation-title">Recommendation for</label>
                                            <input type="text" class="form-control add-recommendation-title" placeholder="Location (field)" value="Location (field)" readonly />
                                          </div>
                                          <div class="form-group">
                                            <label for="add-recommendation-type">Type <span id="add-recommendation-type-location" class="badge hide">Required</span>
                                            </label>
                                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                              <label class="btn btn-default">
                                                <input type="radio" name="type" value="comment" class="add-recommendation-type" autocomplete="off"> Comment </label>
                                              <label class="btn btn-default">
                                                <input type="radio" name="type" value="suggestion" autocomplete="off" class="add-recommendation-type"> Improvement </label>
                                            </div>
                                          </div>
                                          <div class="form-group">
                                            <label for="add-recommendation-content">Recommendation <span id="add-recommendation-content-location" class="badge hide">Required</span>
                                            </label>
                                            <textarea class="form-control add-recommendation-content" rows="3"></textarea>
                                          </div>
                                        </div>
                                        <div class="modal-footer">
                                          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                          <button class="btn btn-success add-recommendation-button" type="button" onclick="addRecommendation('location', 'field', 'destinationAndLocation')">Save</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <script>
                                  function addRecommendation(recommendationName, recommendationType, recommendationSection) {
                                    let field = recommendationName;
                                    let section = recommendationSection;
                                    let targetForm = event.target.closest('.add_recommendations_form')
                                    let feedback = $(targetForm).find('.add-recommendation-content').val();
                                    let type = $(targetForm).find('.add-recommendation-type:checked').val();
                                    let feedbackErrorElement = $(targetForm).find(`#add-recommendation-content-${recommendationName}`);
                                    let typeErrorElement = $(targetForm).find(`#add-recommendation-type-${recommendationName}`);
                                    let translations = {
                                      "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                      "success": "Changes saved successfully"
                                    }
                                    if (recommendationType == 'page') {
                                      section = recommendationSection;
                                      field = '';
                                    }
                                    if (feedback == '' && type == undefined) {
                                      feedbackErrorElement.removeClass('hide')
                                      typeErrorElement.removeClass('hide');
                                      return;
                                    }
                                    if (feedback == '') {
                                      feedbackErrorElement.removeClass('hide');
                                      return;
                                    }
                                    if (type == undefined) {
                                      typeErrorElement.removeClass('hide');
                                      return;
                                    }
                                    let formData = {
                                      "type": type,
                                      "section": section,
                                      "field": field,
                                      "feedback": feedback
                                    }
                                    let options = {
                                      credentials: 'same-origin',
                                      headers: {
                                        'Accept': 'application/json',
                                        'Content-Type': 'application/json'
                                      },
                                      method: 'POST',
                                      body: JSON.stringify(formData)
                                    }
                                    let url = '/4/listings/95462/feedback/json/create'
                                    fetch(url, options).then(function(response) {
                                      if (response.status != 400 && response.status != 200) {
                                        flash.error(translations.error);
                                        console.log(response);
                                      } else {
                                        flash.success(translations.success, function() {
                                          flash.clear()
                                        });
                                        $(`#add_recommendations_modal_${recommendationName}`).modal('hide')
                                        return response.json()
                                      }
                                    })
                                  }
                                </script>
                              </div>
                              <script>
                                function showRecommendationHistory(name) {
                                  let currentElement = event.target;
                                  $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                  $(currentElement).toggleClass('hide');
                                  $(currentElement).next().toggleClass('hide');
                                }
  
                                function hideRecommendationHistory(name) {
                                  let currentElement = event.target;
                                  $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                  $(currentElement).toggleClass('hide');
                                  $(currentElement).prev().toggleClass('hide');
                                }
                              </script>
                            </div>
                          </div>
                        </div>
                        <div class="col-lg-6 col-md-9 col-xs-12">
                          <div class="form-group">
                              {{ form.location_info | safe }}
                          </div>
                          <script>
                            function completeRecommendation(recommendationId) {
                              let translations = {
                                "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                "success": "Changes saved successfully"
                              };
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/complete`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  flash.error(translations.error);
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ Done ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function dismissRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/dismiss`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  if (recommendationType == 'comment') {
                                    flash.error(translations.error);
                                  } else {
                                    flash.error(translations.error);
                                  }
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ DISMISSED ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function deleteRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/delete`
                              if (window.confirm("Are you sure?")) {
                                fetch(url, options).then(function(response) {
                                  if (response.status != 200) {
                                    flash.error(translations.error);
                                    console.log(response);
                                  } else {
                                    flash.success(translations.success, function() {
                                      flash.clear()
                                    });
                                    $(targetElement).closest('.panel-body').hide();
                                    return response.json()
                                  }
                                })
                              }
                            }
  
                            function editRecommendation(recommendationName, type, id) {
                              $(`#edit_recommendations_modal_${recommendationName}_${type}_${id}`).modal('show');
                            }
                          </script>
                        </div>
                      </div>
                      <!------------------------------------------------------- ACCOMODATION ------------------------------------------>
                      <div class="row section-title divider-on-top">
                        <div class="col-md-9 col-sm-12">
                          <h3>Accommodation</h3>
                          <small class="title-description">Describe the accommodation(s) the customers will stay in.</small>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="accommodation" class="control-label label-block"> Content </label>
                            <div class="form-helper"> Formatting help: <br /> - Header starts with a dash <br /> * list items start with asterisk <br /> % paragraphs start with percent <br />
                              <br /> Long lines are turned into paragraphs and short lines are turned into lists automatically. <div class="recommendation-actions">
                                <div class="modal fade add_recommendations_modal" id="add_recommendations_modal_accomodation" tabindex="-1" role="dialog" aria-label>
                                  <div class="modal-dialog modal-lg" role="document">
                                    <div class="modal-content">
                                      <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                          <span aria-hidden="true">
                                            <img src="./recommendationsClose.svg" class="add-recommendations-modal__close__image" />
                                          </span>
                                        </button>
                                        <div class="modal-header__content">
                                          <img src="./recommendations.svg" class="add-recommendations-modal__title__image" />
                                          <h3>Add recommendation</h3>
                                        </div>
                                      </div>
                                      <div class="add_recommendations_form">
                                        <div class="modal-body">
                                          <div class="form-group">
                                            <label for="add-recommendation-title">Recommendation for</label>
                                            <input type="text" class="form-control add-recommendation-title" placeholder="Accommodation (field)" value="Accommodation (field)" readonly />
                                          </div>
                                          <div class="form-group">
                                            <label for="add-recommendation-type">Type <span id="add-recommendation-type-accomodation" class="badge hide">Required</span>
                                            </label>
                                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                              <label class="btn btn-default">
                                                <input type="radio" name="type" value="comment" class="add-recommendation-type" autocomplete="off"> Comment </label>
                                              <label class="btn btn-default">
                                                <input type="radio" name="type" value="suggestion" autocomplete="off" class="add-recommendation-type"> Improvement </label>
                                            </div>
                                          </div>
                                          <div class="form-group">
                                            <label for="add-recommendation-content">Recommendation <span id="add-recommendation-content-accomodation" class="badge hide">Required</span>
                                            </label>
                                            <textarea class="form-control add-recommendation-content" rows="3"></textarea>
                                          </div>
                                        </div>
                                        <div class="modal-footer">
                                          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                          <button class="btn btn-success add-recommendation-button" type="button" onclick="addRecommendation('accomodation', 'field', 'destinationAndLocation')">Save</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <script>
                                  function addRecommendation(recommendationName, recommendationType, recommendationSection) {
                                    let field = recommendationName;
                                    let section = recommendationSection;
                                    let targetForm = event.target.closest('.add_recommendations_form')
                                    let feedback = $(targetForm).find('.add-recommendation-content').val();
                                    let type = $(targetForm).find('.add-recommendation-type:checked').val();
                                    let feedbackErrorElement = $(targetForm).find(`#add-recommendation-content-${recommendationName}`);
                                    let typeErrorElement = $(targetForm).find(`#add-recommendation-type-${recommendationName}`);
                                    let translations = {
                                      "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                      "success": "Changes saved successfully"
                                    }
                                    if (recommendationType == 'page') {
                                      section = recommendationSection;
                                      field = '';
                                    }
                                    if (feedback == '' && type == undefined) {
                                      feedbackErrorElement.removeClass('hide')
                                      typeErrorElement.removeClass('hide');
                                      return;
                                    }
                                    if (feedback == '') {
                                      feedbackErrorElement.removeClass('hide');
                                      return;
                                    }
                                    if (type == undefined) {
                                      typeErrorElement.removeClass('hide');
                                      return;
                                    }
                                    let formData = {
                                      "type": type,
                                      "section": section,
                                      "field": field,
                                      "feedback": feedback
                                    }
                                    let options = {
                                      credentials: 'same-origin',
                                      headers: {
                                        'Accept': 'application/json',
                                        'Content-Type': 'application/json'
                                      },
                                      method: 'POST',
                                      body: JSON.stringify(formData)
                                    }
                                    let url = '/4/listings/95462/feedback/json/create'
                                    fetch(url, options).then(function(response) {
                                      if (response.status != 400 && response.status != 200) {
                                        flash.error(translations.error);
                                        console.log(response);
                                      } else {
                                        flash.success(translations.success, function() {
                                          flash.clear()
                                        });
                                        $(`#add_recommendations_modal_${recommendationName}`).modal('hide')
                                        return response.json()
                                      }
                                    })
                                  }
                                </script>
                              </div>
                              <script>
                                function showRecommendationHistory(name) {
                                  let currentElement = event.target;
                                  $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                  $(currentElement).toggleClass('hide');
                                  $(currentElement).next().toggleClass('hide');
                                }
  
                                function hideRecommendationHistory(name) {
                                  let currentElement = event.target;
                                  $(`#view_recommendations_history_container_${name}`).toggleClass('hide');
                                  $(currentElement).toggleClass('hide');
                                  $(currentElement).prev().toggleClass('hide');
                                }
                              </script>
                            </div>
                          </div>
                        </div>
                        <div class="col-lg-6 col-md-9 col-xs-12">
                          <div class="form-group">
                              {{ form.accomodation_info | safe}}
                          </div>
                          <script>
                            function completeRecommendation(recommendationId) {
                              let translations = {
                                "error": "There was an error saving your changes. Please reload the page and try again. If the error persists, contact your account manager.",
                                "success": "Changes saved successfully"
                              };
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/complete`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  flash.error(translations.error);
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ Done ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function dismissRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/dismiss`
                              fetch(url, options).then(function(response) {
                                if (response.status != 200) {
                                  if (recommendationType == 'comment') {
                                    flash.error(translations.error);
                                  } else {
                                    flash.error(translations.error);
                                  }
                                  console.log(response);
                                } else {
                                  flash.success(translations.success, function() {
                                    flash.clear()
                                  });
                                  $(targetElement).closest('.panel-body').find('.content-section span').html('[ DISMISSED ]');
                                  $(targetElement).closest('.button-section').hide();
                                  return response.json()
                                }
                              })
                            }
  
                            function deleteRecommendation(recommendationId, recommendationType) {
                              let targetElement = event.target;
                              let options = {
                                credentials: 'same-origin',
                                headers: {
                                  'Accept': 'application/json',
                                  'Content-Type': 'application/json'
                                },
                                method: 'POST'
                              }
                              let url = `/4/listings/95462/feedback/${recommendationId}/json/delete`
                              if (window.confirm("Are you sure?")) {
                                fetch(url, options).then(function(response) {
                                  if (response.status != 200) {
                                    flash.error(translations.error);
                                    console.log(response);
                                  } else {
                                    flash.success(translations.success, function() {
                                      flash.clear()
                                    });
                                    $(targetElement).closest('.panel-body').hide();
                                    return response.json()
                                  }
                                })
                              }
                            }
  
                            function editRecommendation(recommendationName, type, id) {
                              $(`#edit_recommendations_modal_${recommendationName}_${type}_${id}`).modal('show');
                            }
                          </script>
                        </div>
                      </div>
                      <!--------------------------------------------------- Form End ---------------------------------------->
                      <div class="fixed-actions fixed-actions--bottom fixed-actions--right">
                          <button class="btn btn-success js-submit-listing-edit-form"> Save </button>
                        </div>
                    </form>
                    <!-- ------------------------------------------------ SUBMIT --------------------------------------- -->
                  </div>
              </div>
            </div>
            {% endblock %}